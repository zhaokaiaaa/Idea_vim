" ================================================================================================
" = plug settings =====================================
 ================================================================================================
Plug 'tpope/vim-surround'
Plug 'preservim/nerdtree'
Plug 'easymotion/vim-easymotion'
Plug 'machakann/vim-highlightedyank'
set quickscope
set multicursor
let g:highlightedyank_highlight_duration = "1000"
let g:highlightedyank_highlight_color = "rgba(227, 175, 188,  150)"
let g:qs_primary_color = '#AA4C8F'
let g:qs_secondary_color = '#AA4C8F'
nmap <C-A-n> <Plug>(multicursor-ms/)

" ================================================================================================
" = Leader Keymaps =====================================
" ================================================================================================
let mapleader=" "
" ================================================================================================
" = Basic settings =====================================
" ================================================================================================
set showmode
set clipboard+=unnamed
set scrolloff=10
set history=200
"å¿½ç•¥å¤§å°å†™
set ignorecase
"æ™ºèƒ½åŒ¹é…
set smartcase
"è¡Œå·
set number
"ç›¸å¯¹è¡Œå·
set relativenumber
set incsearch
set hlsearch
"é»˜è®¤åˆ†å±
set splitright
set splitbelow
"çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ
set cursorline
"keep in English
set keep-english-in-normal
set keep-english-in-normal-and-restore-in-insert
"ç½®ç©ºsé”®
nmap s <nop>
nmap S <nop>
nmap <leader>s <Plug>(easymotion-s)

""" Idea specific settings ------------------
set ideajoin
set ideastatusicon=gray
set idearefactormode=keep
" Use ctrl-c as an ide shortcut in normal and visual modes
sethandler <C-C> v:ide
sethandler <C-A> n:ide
sethandler <C-V> i:ide
" ================================================================================================
" = No Leader Keymaps =====================================
" ================================================================================================
nmap ge <action>(GotoNextError)
nmap gt <action>(GotoTest)
nmap gm <action>(MethodDown)
nmap gM <action>(MethodUp)
nmap gi <action>(GotoImplementation)
nmap gb <action>(Back)
nmap gf <action>(Forward)
" last changed in current buffer(file)
nmap ga '.
map <C-s> :w<CR>
map L <action>(NextTab)
map H <action>(PreviousTab)
"å±•ç¤ºèœå•
nmap <silent> sm <action>(ShowPopupMenu)
nmap <silent> sf <action>(RevealIn)
map <silent> K 5k
map <silent> J 5j
" Faster in-line navigation
nmap W 5w
nmap B 5b

" gh key: go to the first word the line
map <silent> gh ^
" gl key: go to the end of the line
map <silent> gl $

" ==============================================================================================
" = Window management =====================================
" ================================================================================================
" Resize splits with arrow keys
nmap <up> :res +5<CR>
nmap <down> :res -5<CR>
nmap <left> :vertical resize-5<CR>
nmap <right> :vertical resize+5<CR>
" split windows
nmap sj :set splitbelow<CR>:split<CR>
nmap sk :set nosplitbelow<CR>:split<CR>:set splitbelow<CR>
nmap sh :set splitright<CR>:vsplit<CR>
nmap sl :set nosplitright<CR>:vsplit<CR>:set splitright<CR>

" ================================================================================================
" ğŸ‘»ğŸ‘»ğŸ‘» Which-Key ğŸ‘»ğŸ‘»ğŸ‘»
" ================================================================================================
set which-key
set notimeout
nmap <ESC> :nohl<CR>

let g:WhichKeyDesc_CommentByLineComment = "<leader>;; CommentByLineComment"
nmap <leader>;; :action CommentByLineComment<CR>

" a:
let g:WhichKeyDesc_Select = "<leader>A SelectAll"
nmap <leader>A maggVG

" e: Toggle Explorer â­ï¸
let g:WhichKeyDesc_ToggleExplorerOrExtract = "<leader>e å±•ç¤ºæ–‡ä»¶èœå•"
nmap <leader>e :NERDTreeFocus<CR>


" f: Find/Format â­ï¸;
let g:WhichKeyDesc_FindOrFormat = "<leader>f FindOrFormatOrFile"
let g:WhichKeyDesc_FindOrFormat_FindFile = "<leader>ff æ‰“å¼€æ–‡ä»¶æœç´¢æ¡†"
nmap <leader>ff <action>(GotoFile)

let g:WhichKeyDesc_FindOrFormat_FileStructure = "<leader>fs æ–‡ä»¶ç»“æ„"
nmap <leader>fs <action>(FileStructurePopup)
let g:WhichKeyDesc_FindOrFormat_FindFileLocation = "<leader>fl è·³è½¬åˆ°æ–‡ä»¶æ‰€åœ¨ä½èœå•çš„ä½ç½®"
nmap <leader>fl <action>(SelectInProjectView)

let g:WhichKeyDesc_FindOrFormat_FindText = "<leader>fw åœ¨é¡¹ç›®ä¸­æŸ¥æ‰¾æ–‡æœ¬"
nmap <leader>fw <action>(FindInPath)

let g:WhichKeyDesc_FindOrFormat_Commands = "<leader>fc æ‰“å¼€æ“ä½œæŸ¥æ‰¾æ¡†"
nmap <leader>fa <action>(GotoAction)

let g:WhichKeyDesc_FindOrFormat_OpenedProject = "<leader>fp æ‰“å¼€é¡¹ç›®çª—å£"
nmap <leader>fp <action>(OpenProjectWindows)

let g:WhichKeyDesc_FindOrFormat_Format = "<leader>fm æ ¼å¼åŒ–ä»£ç "
nmap <leader>fm <action>(ReformatCode) \| <action>(OptimizeImports)

" g: Git â­ï¸
let g:WhichKeyDesc_Git = "<leader>g Git"
let g:WhichKeyDesc_Git_RollbackHunk = "<leader>gr RollbackHunk"
nmap <leader>gr :action Vcs.RollbackChangedLines<CR>

" i: Insert â­ï¸
let g:WhichKeyDesc_InsertAfterBrackets = "<leader>i InsertAfterBrackets"
nmap <leader>i f(

"n: new Class with ncNewClass
let g:WhichKeyDesc_NewClass ="<leader>nc NewClass"
nmap <leader>nc :action NewClass<CR>
" p: paste
let g:WhichKeyDesc_PasteFromSelectAll = "<leader>P PasteFromSelectAll"
nmap <leader>P "bp
" q :quit
let g:WhichKeyDesc_Quit ="<leader>Quit"
nmap <leader>q :wq<CR>
" r: Run/Re â­ï¸
let g:WhichKeyDesc_RunOrRe = "<leader>r RunOrRe"
let g:WhichKeyDesc_RunOrRe_ReRun = "<leader>rr ReRun"
nmap <leader>rr <action>(Rerun)
let g:WhichKeyDesc_RunOrRe_ReRunTests = "<leader>rt ReRunTests"
nmap <leader>rt <action>(RerunTests)
let g:WhichKeyDesc_RunOrRe_ReDebug = "<leader>rd RunDebug"
nmap <leader>rd <action>(ChooseDebugConfiguration)
let g:WhichKeyDesc_RunOrRe_Rename = "<leader>re Rename"
nmap <leader>re <action>(RenameElement)
let g:WhichKeyDesc_RecentFiles= "<leader>rf RecentFiles"
nmap <leader>rf <action>(RecentFiles)

let g:WhichKeyDesc_Show_ParameterInfo = "<leader>pi ShowParameterInfo"
nmap <leader>pi <action>(ParameterInfo)

" u: upper lower â­ï¸
let g:WhichKeyDesc_UpperAndLower = "<leader>u UpperAndLower"
let g:WhichKeyDesc_UpperAndLower_Upper = "<leader>U Upper"
nmap <leader>U viwU
let g:WhichKeyDesc_UpperAndLower_Lower = "<leader>u Lower"
nmap <leader>u viwu

" w: Window â­ï¸
" window options
nmap <leader>wj <C-W>j
nmap <leader>wk <C-W>k
nmap <leader>wh <C-W>h
nmap <leader>wl <C-W>l
let g:WhichKeyDesc_Windows = "<leader>w Windows"
let g:WhichKeyDesc_Windows_CloseAllWindow = "<leader>ww CloseWindow"
nmap <leader>ww <c-w>c
let g:WhichKeyDesc_CloseThisWindow = "<leader>c CloseThisWindow"
nmap <leader>wc :q!<CR>

" y: copy all
let g:WhichKeyDesc_CopyAll = "<leader>Y Copy All"
nmap <leader>Y maggVG"by

" z: regions â­ï¸
let g:WhichKeyDesc_Regions="<leader>z Regions"
let g:WhichKeyDesc_ExpandAllRegions= "<leader> zo ExpandAllRegions"
nmap <leader>zo <action>(ExpandAllRegions)
let g:WhichKeyDesc_CollapseAllRegions= "<leader> zc CollapseAllRegions"
nmap <leader>zc <action>(CollapseAllRegions)

imap ,; <ESC>A;<ESC>
"===================================================================================
"========= æ’ä»¶ä½¿ç”¨ä»‹ç» =========
"===================================================================================
"========= NERTTree =========
" NERDTreeæä¾›äº†ä¸°å¯Œçš„é”®ç›˜æ“ä½œæ–¹å¼æ¥æµè§ˆå’Œæ‰“å¼€æ–‡ä»¶ï¼Œä»‹ç»ä¸€äº›å¸¸ç”¨çš„å¿«æ·é”®ï¼š
"   å’Œç¼–è¾‘æ–‡ä»¶ä¸€æ ·ï¼Œé€šè¿‡h j k lç§»åŠ¨å…‰æ ‡å®šä½
"   æ‰“å¼€å…³é—­æ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œå¦‚æœæ˜¯æ–‡ä»¶çš„è¯ï¼Œå…‰æ ‡å‡ºç°åœ¨æ‰“å¼€çš„æ–‡ä»¶ä¸­
"   go æ•ˆæœåŒä¸Šï¼Œä¸è¿‡å…‰æ ‡ä¿æŒåœ¨æ–‡ä»¶ç›®å½•é‡Œï¼Œç±»ä¼¼é¢„è§ˆæ–‡ä»¶å†…å®¹çš„åŠŸèƒ½
"   iå’Œså¯ä»¥æ°´å¹³åˆ†å‰²æˆ–çºµå‘åˆ†å‰²çª—å£æ‰“å¼€æ–‡ä»¶ï¼Œå‰é¢åŠ gç±»ä¼¼goçš„åŠŸèƒ½
"   t åœ¨æ ‡ç­¾é¡µä¸­æ‰“å¼€
"   T åœ¨åå°æ ‡ç­¾é¡µä¸­æ‰“å¼€
"   p åˆ°ä¸Šå±‚ç›®å½•
"   P åˆ°æ ¹ç›®å½•
"   K åˆ°åŒç›®å½•ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
"   J åˆ°åŒç›®å½•æœ€åä¸€ä¸ªèŠ‚ç‚¹
"   m æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿèœå•ï¼ˆæ·»åŠ ã€åˆ é™¤ã€ç§»åŠ¨æ“ä½œï¼‰
"   ? å¸®åŠ©
"   q å…³é—­

"| Key     |  Description                                            |  Map Setting                   |
"|---------|---------------------------------------------------------|--------------------------------|
"| `o`     |  Open files, directories and bookmarks                  | `g:NERDTreeMapActivateNode`    |
"| `go`    |  Open selected file, but leave cursor in the NERDTree   | `g:NERDTreeMapPreview`         |
"| `t`     |  Open selected node/bookmark in a new tab               | `g:NERDTreeMapOpenInTab`       |
"| `T`     |  Same as 't' but keep the focus on the current tab      | `g:NERDTreeMapOpenInTabSilent` |
"| `i`     |  Open selected file in a split window                   | `g:NERDTreeMapOpenSplit`       |
"| `gi`    |  Same as i, but leave the cursor on the NERDTree        | `g:NERDTreeMapPreviewSplit`    |
"| `s`     |  Open selected file in a new vsplit                     | `g:NERDTreeMapOpenVSplit`      |
"| `gs`    |  Same as s, but leave the cursor on the NERDTree        | `g:NERDTreeMapPreviewVSplit`   |
"| `O`     |  Recursively open the selected directory                | `g:NERDTreeMapOpenRecursively` |
"| `x`     |  Close the current nodes parent                         | `g:NERDTreeMapCloseDir`        |
"| `X`     |  Recursively close all children of the current node     | `g:NERDTreeMapCloseChildren`   |
"| `P`     |  Jump to the root node                                  | `g:NERDTreeMapJumpRoot`        |
"| `p`     |  Jump to current nodes parent                           | `g:NERDTreeMapJumpParent`      |
"| `K`     |  Jump up inside directories at the current tree depth   | `g:NERDTreeMapJumpFirstChild`  |
"| `J`     |  Jump down inside directories at the current tree depth | `g:NERDTreeMapJumpLastChild`   |
"| `<C-J>` |  Jump down to next sibling of the current directory     | `g:NERDTreeMapJumpNextSibling` |
"| `<C-K>` |  Jump up to previous sibling of the current directory   | `g:NERDTreeMapJumpPrevSibling` |
"| `r`     |  Recursively refresh the current directory              | `g:NERDTreeMapRefresh`         |
"| `R`     |  Recursively refresh the current root                   | `g:NERDTreeMapRefreshRoot`     |
"| `m`     |  Display the NERDTree menu                              | `g:NERDTreeMapMenu`            |
"| `q`     |  Close the NERDTree window                              | `g:NERDTreeMapQuit`            |
"| `A`     |  Zoom (maximize/minimize) the NERDTree window           | `g:NERDTreeMapToggleZoom`      |

"========= vim.surround =========
"   It's easiest to explain with examples. Press cs"' inside
"   "Hello world!"
"   to change it to
"   'Hello world!'

"   Now press cs'<q> to change it to
"   <q>Hello world!</q>
"   To go full circle, press cst" to get
"   "Hello world!"

"   To remove the delimiters entirely, press ds".
"   Hello world!

"   Now with the cursor on "Hello", press ysiw] (iw is a text object).
"   [Hello] world!

"   Let's make that braces and add some space (use } instead of { for no space): cs]{
"   { Hello } world!

"   Now wrap the entire line in parentheses with yssb or yss).
"   ({ Hello } world!)

"   Revert to the original text: ds{ds)
"   Hello world!

"   Emphasize hello: ysiw<em>
"   <em>Hello</em> world!